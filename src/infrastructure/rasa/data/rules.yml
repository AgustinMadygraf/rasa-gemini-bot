version: "3.1"

rules:
  # Gemini fallback rules (new)
  - rule: Gemini fallback for low confidence or unknown flow
    steps:
      - intent: fallback
      - action: action_gemini_fallback

  - rule: Gemini fallback for unhandled informar_git outside form
    condition:
      - active_loop: null
    steps:
      - intent: informar_git
      - action: action_gemini_fallback

  - rule: Gemini fallback for unhandled out_of_scope
    steps:
      - intent: out_of_scope
      - action: action_gemini_fallback

  # Original rules (keep these)
  - rule: Decir adiós cada vez que el usuario se despida
    steps:
    - intent: despedida
    - action: utter_despedida

  - rule: Decir 'Soy un bot' cada vez que el usuario desafíe
    steps:
    - intent: desafio_bot
    - action: utter_yosoyunbot

  - rule: Animar cuando el usuario está triste
    steps:
    - intent: estado_triste
    - action: utter_cheer_up
    - action: utter_did_that_help

  - rule: Activar formulario instalar_rasa_form
    steps:
    - intent: asistencia_tecnica
    - action: utter_asistencia_tecnica
    - action: instalar_rasa_form
    - active_loop: instalar_rasa_form

  - rule: Completar formulario instalar_rasa_form
    condition:
    - active_loop: instalar_rasa_form
    steps:
    - action: instalar_rasa_form
    - active_loop: null
    - action: action_provide_next_steps

